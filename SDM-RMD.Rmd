---
title: "SDM II Project"
output: pdf_document
date: "2023-04-26"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

#Loading Necessary Libraries

library(xts)
library(readr)
library(viridis)
library(lubridate)

library(ggplot2)
library(plotly)
library(viridis)
library(reshape2)
library(zoo)
library(Quandl)
library(dygraphs)
library(shiny)
library(tidyverse)
library(forecast)
```

## Change In Volatility Over Time

| Financial risk has many faces, and we measure it in many ways, but for now, let's agree that it is a measure of the possible loss on an investment. In financial markets, where we measure prices frequently, volatility (which is analogous to *standard deviation*) is an obvious choice to measure risk. But in real markets, volatility changes with the market itself.
| 
| 

![Returns Of Four Different Assets](T-Bonds.png)

| 

The image presented depicts the returns of four distinct assets, each displaying a pattern of alternating periods of high and low volatilities. Notably, the greatest volatility occurred near the conclusion of 2008, which coincided with the most severe stage of the recent financial crisis.

```{r}

# Testing Quandl API

data <- Quandl("FED/SVENY")

```

## Daily Estimates in 2022

```{r}

tail(data)
```

## Exploratory Data Analysis

```{r}

na_vals <- colSums(is.na(data))

plot(na_vals, main = "NA Values Trend")

```

### Plotting 30 Year Rates To Check NAN Values

```{r}


ggplot(data, aes(x = Date, y = SVENY30)) +
  geom_line() +
  xlab("Date") +
  ylab("Rate") +
  ggtitle("30 Year Rate")
  




```

```{r}


# SVENY01

ggplot(data, aes(x = Date, y = SVENY01)) +
  geom_line() +
  xlab("Date") +
  ylab("Rate") +
  ggtitle("1 Year Rate")

```

| 

Since the missing values were randomly distributed and accounted for a small proportion of the dataset, we decided to drop them from our analysis instead of using any imputation method, which could introduce bias. The line plot was used to confirm that there were no missing data points in between the available data.

## Dropping NA Values

```{r}

# Droopping NA Values

data <- na.omit(data)

```

```{r}



```

```{r}


plot(colSums(is.na(data)), main = "NA Values")
```

## Converting Data To Time Series

```{r}

data_xts <- as.xts(x = data[, -1], order.by = as.Date(data$Date))

#data_xts <- subset(data_xts, select = -SVENY30_missing)

```



```{r}

plot(data_xts, main = "Evolution Of US Zero Coupon Yields")
```

### Rates - BEFORE COVID

```{r}

# Filter

# Filter data for the year 2019
data_xts_2019 <- data_xts[format(index(data_xts), "%Y") == "2019"]
```

```{r}


```

```{r}

# Before COVID, 2019

dygraph(data_xts_2019, 
        main = "All Zero Coupon Yields (1-30) 2019 | Before COVID", 
        ylab = "Value") %>%
  dyAxis('x', axisLabelFontSize = 12) %>%
  dyRangeSelector() %>%
  dyLegend(show = "follow") 

```

### Rates - AFTER COVID

```{r}

# Filter data for the year 2022
data_xts_after <- data_xts[format(index(data_xts), "%Y") >= "2022"]
```

```{r}


dygraph(data_xts_after, 
        main = "All Zero Coupon Yields (1-30) | After COVID", 
        ylab = "Value") %>%
  dyAxis('x', axisLabelFontSize = 12) %>%
  dyRangeSelector() %>%
  dyLegend(show = "follow") 
```

## Plotting After Differentiation

```{r}

# Testing Quandl API

df <- Quandl("FED/SVENY")

```

```{r}

df_xts <- as.xts(x = df[, -1], order.by = df$Date)

df_xts_diff <- diff.xts(df_xts)

head(df_xts_diff)


```

```{r}

# Plotting the differentiated time series

plot.palette <- rainbow(n = 30)

plot.zoo(x = df_xts_diff, plot.type = "multiple", ylim = c(-0.5, 0.5), 
         cex.axis = 0.7, ylab = 1:30, col = plot.palette, 
         main = "All Zero Coupon Yields (1-30) Differenced", xlab = "Index")



```

### Checking For Autocorrelations

```{r}

data_xts_diff_2010 <- df_xts_diff["2010/",]
sveny01 <- data_xts_diff_2010[, "SVENY01"]
sveny15 <- data_xts_diff_2010[, "SVENY15"]




```

```{r}

# Plot

par(mar=c(5.1, 4.1, 4.1, 2.1))
par(mfrow=c(2,2))
acf_1 <- acf(sveny01)
acf_15 <- acf(sveny15)

# Plot the autocorrelations of the absolute changes of yields
acf_abs_1 <- acf(abs(sveny01))
acf_abs_15 <- acf(abs(sveny15))



```

